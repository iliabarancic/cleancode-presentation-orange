<div class="slides" id="slides">
    <section>        
        <h1>DAB TechTalk</h1>
        <div>
            <img alt="logo" src="/images/logo.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0">
        </div>                
        <p>
            <small>von <a href="mailto:stefan.schoeffmann@posteo.de">Stefan Sch√∂ffmann</a> / <a href="http://twitter.com/schoeffm">@schoeffm</a></small>
        </p>    
    </section>

    <!-- ######################################## SECTION 1 ############################################## -->
    
    <section>
        <section>
            <h1>What is Docker?</h1>
            <h3 class="fragment">... a (very) brief introduction</h3>
        </section>
        <section>
            <h3>What Is Docker?</h3>
            <div>An open platform for distributed applications</div><br/>
            <div>
                <img alt="docker_vs_vm" src="/images/what-is-docker.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
                <div style="width: 50%; float: left;">
                    <div style="font-size: 0.8em;">Docker Engine</div>
                    <div style="font-size: 0.5em;">A portable, lightweight application<br/>runtime and packaging tool.</div>
                </div>
                <div style="width: 50%; float: right;">
                    <div style="font-size: 0.8em;">Docker Hub</div>
                    <div style="font-size: 0.5em;">A cloud service for sharing<br/>applications and automating workflows.</div>
                </div>
                <div class="source">source <a href="www.docker.com">www.docker.com</a></div>
                <aside class="notes">
                    <div>taken from the landing-page of <a href="https://www.docker.com">docker.com</a><br/>nice image, buzzy words - but not very explanatory</div>
                </aside>
            </div>
        </section>
        <section>
            <h2>Now, what is Docker</h2>                 
            <div><em>... and how is it different?</em></div><br/>
        </section>
        <section>
            <div>
                <img alt="docker_vs_vm" src="/images/docker_vs_vm.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
                <div class="source">source <a href="https://www.docker.com/whatisdocker/">www.docker.com/whatisdocker</a></div>
            </div>
             <aside class="notes">
                <ul>
                    <li>you have to stick with one OS-Stack (no windows-Container)</li>
                    <li>much more lightweight, faster and scaleable (from a dev point of view)</li>
                </ul>
            </aside>  
        </section>
        <section>
            <h2>... so, what <em>is</em>&nbsp;&nbsp;Docker</h2>
            <div>... essentially a layer on top of already existing <br/><span class="emph">linux kernel</span> technologies!</div><br/>
            <ul>
                <li class="fragment">A native Linux container format (formerly <a href="http://linuxcontainers.org">lxc</a>, now <a href="https://github.com/docker/libcontainer">libcontainer</a>)</li>
                <ul>
                    <li class="fragment">Linux kernel namespaces: Filesystem, Process and Network isolation</li>
                    <li class="fragment"><a href="http://en.wikipedia.org/wiki/Cgroups">cgroups</a> (control groups) for 
                        resource management (i.e. memory), prioritization (CPU usage, I/O)</li>
                    </li>
                </ul>
            </ul>
            <aside class="notes">
                the most interesting technologies are:
                <ul>
                    <li>A native Linux container format that Docker calls libcontainer, as well as the popular container platform, lxc. The libcontainer format is now the default format.</li>
                    <li>Linux kernel namespaces, which provide isolation for filesystems, processes, and networks.
                        <ul>
                            <li>Filesystem isolation: each container is its own root filesystem.
                            <li>Process isolation: each container runs in its own process environment.
                            <li>Network isolation: separate virtual interfaces and IP addressing between containers.
                        </ul>
                    </li>
                    <li>Resource isolation and grouping: resources like CPU and memory are allocated individually to each Docker container using the cgroups, or control groups, kernel feature.</li>
                </ul>
            </aside>
        </section>
        <section>
            <div>All these things form the <span class="emph">Docker-Deamon</span></div><br/>
            <div class="fragment">... and through the <span class="emph">Docker-Client</span> you can <br/>manage and control this deamon</div><br/>
            <aside class="notes">
                <ul>
                    <li>the deamon manages images, runs and creates container based on these images</li>
                    <li>it gets installed on a (linux-based) host-system</li>
                    <li>and exposes a REST-based interface</li>
                    <li>which can be used to control and instruct the deamon</li>
                    <li>docker ships with a CLI client</li>
                </ul>
            </aside>
        </section>
        <!--section>
            <div>
                <img alt="docker_vs_vm" src="/images/client_server.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
            </div>
        </section>
        <section>
            <div>
                <img alt="docker_vs_vm" src="/images/client_server_0.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
            </div>
        </section-->
        <section>
            <div>
                <h2>Setup</h2>
                <div>Client/Server</div>
                <img alt="docker_vs_vm" src="/images/client_server_1.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
            </div>
            <aside class="notes">
                <div>compared to the layered view from above, you have </div>
                <ul>
                    <li>a deamon-installation on a real (linux) system (like ubuntu)</li>
                    <li>on that host-system containers are actually executed</li>
                    <li>using a (remote) client you can manage that deamon - CRUD on container</li>
                </ul>
            </aside>
        </section>
        <section>
            <div>... and what about <span class="emph">non-linux</span> machines?</div>
        </section>
        <section>
            <div>
                <h2>Setup - on Dev Machines</h2>
                <img alt="docker_vs_vm" src="/images/client_server_2.png" class="plain" style="text-align: center; box-shadow: 0 0 0 ; border: 0px; margin: 0"/>
            </div>
            <aside class="notes">
                <div>on Mac and Windows-Systems you'll need a Linux-Host -> Boot2Docker</div>
                <ul>
                    <li>VirtualBox + Tinycore Linux image</li>
                    <li>more flexibility
                        <ul>
                            <li>everybody uses the same setup</li>
                            <li>you can have more than one deamon on your dev-machine</li>
                        </ul>
                    </li>
                </ul>
            </aside>
        </section>
        <section>
                <h2>Recap</h2>
                <div>As stated <a href="#/1">above</a>:</div>
                <blockquote cite="http://www.docker.com">
                    &ldquo; Docker is a portable, lightweight application<br/>runtime and packaging tool.&rdquo;
                </blockquote>
        </section>
    </section>

    <!-- ######################################## SECTION 2 ############################################## -->

    <section>
        <section>
            <h1>Getting Started</h1>
            <h3 class="fragment">... with Containers</h3>
        </section>
        <section>
            <h1>Demo</h1>
        </section>
        <section>
            <h2>Demo - Recap</h2>
            <pre><code>$ docker run -i -t ubuntu /bin/bash</code></pre>
            <ul>
                <li>check the ip / process list / hostname</li>
                <li>install a new package - and exit the container</li>
            </ul>
            <pre><code>$ docker ps -a</code></pre>
            <ul>
                <li>check the container-state and start it again</li>
            </ul>
            <pre><code>$ docker attach `docker ps -lq`</code></pre>
            <ul>
                <li>attach to the running container - check the installation</li>
                <li>finally - get rid of the container</li>
            </ul>
            <pre><code>$ docker rm `docker ps -lq`</code></pre>
            
        </section>
        <section>
            <h2>Pulling an image</h2>
            <script type="text/javascript" src="https://asciinema.org/a/18627.js" id="asciicast-18627" async></script>
        </section>
    </section>

    <!-- ######################################## SECTION 3 ############################################## -->
    
    <section>
        <section>
            <h1>Images & Containers</h1>
            <h3 class="fragment">... heading for reproducability</h3>
        </section>
        <section>
            <h2>Images... </h2>
            <ul style="list-style-type:none">
                <li class="fragment">... are the <span class="emph">blueprint</span> for containers</li>
                <ul style="list-style-type:none">
                    <li class="fragment"><i>(like classes are blueprints for objects)</i></li>
                </ul>
                <li class="fragment">... are hosted in - and pulled from - a <span class="emph">registry</span></li>
                <ul style="list-style-type:none">
                    <li class="fragment"><i>(like the central <a href="https://registry.hub.docker.com/search?q=library">docker hub</a>)</i></li>
                </ul>
                <li class="fragment">... are then stored in your docker host</li>
                <ul style="list-style-type:none">
                    <li class="fragment"><i>(ready to be used for creating/running containers)</i></li>
                </ul>
            </ul>
        </section>
        <section>
            <h2>... quite vague, isn't it?</h2>
            <div class="fragment">let's have a look at ...</div>
        </section>
        <section>
            <h2>The structure of an Image</h2>
            <div style="color:white; background-color: rgb(143,197,197);" class="fragment imagelayer">
                <div>bootfs</div>
                <div style="font-size: 0.5em; font-style: italic">cgroups, namespace ...</div>
                <div style="font-size: 0.5em; font-style: italic">Kernel</div>
            </div>
            <div style="background-color: rgb(224,240,216)" class="fragment imagelayer">
                <div class="imagelayerid">2103b00b3fdf</div>
                <div>Base Image</div>
                <div style="font-size: 0.5em; font-style: italic">Ubuntu</div>
            </div>
            <div style="background-color: rgb(224,240,216)" class="fragment imagelayer">
                <div class="imagelayerid">8da1623d0e4f</div>
                <div >Image</div>
                <div style="font-size: 0.5em; font-style: italic">Add Apache</div>
            </div>
            <div style="background-color: rgb(224,240,216)" class="fragment imagelayer">
                <div class="imagelayerid">611a96f626d2</div>
                <div>Image</div>
                <div style="font-size: 0.5em; font-style: italic">Add vim</div>
            </div>
            <div style="color: white; background-color: rgb(35,184,235)" class="fragment imagelayer">
                <div style="color:black" class="imagelayerid">e72ac664f4f0</div>
                <div>Writeable Container</div>
            </div>
            <aside class="notes">
                <ul>
                    <li>filesystems layered over each other</li>
                    <ul>
                        <li>bootfs: will be removed from memory after boot</li>
                        <li>rootfs: operating system (like ubuntu)</li>
                    </ul>
                    <li>every layer is called <b>an image</b></li>
                    <li>all these layers are <b>read-only</b></li>
                    <li>at the very top a read-write layer will be placed for the container</li>
                    <ul>
                        <li><a href="http://en.wikipedia.org/wiki/Union_mount">union mount</a></li>
                        <li>files will be copied from below up to this layer and will be changed here</li>
                    </ul>
                </ul>
                <div>boot2docker ssh -> /var/lib/docker</div>
            </aside>
        </section>
        <section>
            <h2>Let's create some images</h2>
        </section>
        <section>
            <h2>Demo - Recap 1/2</h2>
            <pre><code>$ docker search ubuntu && docker pull ubuntu</code></pre>
            <ul>
                <li>searchs and retrieves an image from central hub</li>
            </ul>
            <pre><code>$ docker commit 4aab3ce3cb76 schoeffm/techtalk</code></pre>
            <ul>
                <li>turn a running container into an image - but ...</li>
                <li>... image(-creation) is <span class="emph">not reproducible</span></li>
                <li>... nor automatable</li>
            </ul>
            <pre><code>$ docker build -t="schoeffm/techtalk2" .</code></pre>
            <ul>
                <li>reproducible image creation (along with metadata)</li>
                <li>image-blueprint can be version controlled</li>
                <li>execute commands on container start</li>
            </ul>
        </section>
        <section>
            <h2>Demo - Recap 2/2</h2>
            <pre><code data-trim contenteditable>
                FROM ubuntu:14.04
MAINTAINER Stefan Schoeffmann &lt;stefan.schoeffmann@posteo.de&gt;

ENV NGINX_VERSION 1.7.11-1~wheezy
                
RUN sudo apt-get update
RUN sudo apt-get install -y nginx=${NGINX_VERSION}
RUN echo "daemon off;" >> /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx"]
            </code></pre>
            <ul>
                <li>build-time instructions (executed during <code>docker build</code>)</li>
                <li>runtime instructions (executed during <code>docker run</code>)</li>
            </ul>            
            <pre><code>$ docker rmi schoeffm/techtalk2</code></pre>
            <ul>
                <li>get rid of an image (beware of tags & running container)</li>
            </ul>
        </section>
    </section>

    <!-- ######################################## SECTION 3 ############################################## -->
    
    <section>
        <section>
            <h1>Container Interaction</h1>
        </section>
        <section>
            <img src="images/connecting_1.png"/>
            <br/><div class="fragment">... a service on its own is not always sufficient</div>
        </section>
        <section>
            <img src="images/connecting_2.png"/>
            <div>... you can link containers via<br/>dedicated network-routes</div>
        </section>
        <section>
            <img src="images/connecting_3.png"/>
            <div>... and for those that don't expose<br/>a network interface</div>
        </section>
        <section>
            <img src="images/connecting_4.png"/>
            <div>... you can directly share parts of their <br/>file-system (called volumes)</div>
        </section>
        <section>
            <h2>A short glimpse into multi-container handling</h2>
        </section>
        <section>
            <div>Commandline calls like</div>
            <pre><code>docker run -d --name owncloud -p 80:80 -p 443:443 \
    --link owncloud-db:mysql --volumes-from owncloud-data \
    -e OWNCLOUD_SERVERNAME=your.domain.org schoeffm/rpi-owncloud</code></pre>
            <div>... can be quite cumbersome, right?</div>
        </section>
        <section>
            <div><code>docker-compose</code> mitigates that problem</div>
            <div class="fragment">... and lets you describe a complete multi-container setup within one (YAML-)file:
            <pre><code>owncloud:
    image: schoeffm/rpi-owncloud
    ports:
        - "80:80"
        - "443:443"
    links:
        - db:mysql
    volumes_from:
        - data
    environment:
        OWNCLOUD_SERVERNAME: dockerpi
data:
    image: schoeffm/rpi-owncloud-data                
db:
    image: schoeffm/rpi-owncloud-mysql
    expose:
        - "3306"
    environment:
        MYSQL_ROOT_PASSWORD: mypassword
        OWNCLOUD_DB_USER: owncloud
        OWNCLOUD_DB_PASSWORD: mycloud</code></pre></div>
        <div class="fragment">... then, start everyhing using:
        <pre ><code>docker-compose up</code></pre></div>
        </section>
    </section>

    <!-- ######################################## SECTION 3 ############################################## -->
    
    <section>
        <section>
            <h1>Usage Scenarios & Examples</h1>
            <h3 class="fragment">from a developers point of view</h3>
        </section>
        <section>
            <h2>Example #1</h2>
            <div>Adhoc log-file analysis using 
                <a href="https://www.elastic.co/products/elasticsearch">E</a><a href="http://logstash.net/">L</a><a href="https://github.com/elastic/kibana">K</a>
            </div>
        </section>
        <section>
            <h2>General Setup</h2>
            <img class="plain" src="images/elk.png"/>
        </section>
        <section>
            <h2>Container Setup</h2>
            <img class="plain" src="images/elk_container.png"/>
        </section>
        <section>
            <h2>Demo</h2>
        </section>
        <!--section>
            <h2>Example #2</h2>
            <div>Jenkins CI with docker-environments</div>
        </section>
        <section>
            <h2>Demo</h2>
        </section-->
        <section>
            <h2>Example #2</h2>
            <div>scalable/portable microservices using containers</div>
        </section>
        <section>
            <h2>Container Setup</h2>
            <img class="plain" src="images/instafifa.png"/>
        </section>
        <section>
            <h2>Demo</h2>
        </section>
    </section>
    <section>
        <h1 style="margin-left:-150px;">That's it ...</h1>
        <h1 style="margin-left:150px;" class="fragment">... Questions?</h1>
    </section>
    <!--section>
        <pre><code data-trim contenteditable>
function linkify( selector ) {
  if( supports3DTransforms ) {

    var nodes = document.querySelectorAll( selector );

    for( var i = 0, len = nodes.length; i &lt; len; i++ ) {
      var node = nodes[i];

      if( !node.className ) {
        node.className += ' roll';
      }
    }
  }
}
        </code></pre>           
    </section-->
    <!--section>
        <iframe width="900" height="650" scrolling="no" src="http://localhost:3000/"></iframe> 
    </section-->
</div>

